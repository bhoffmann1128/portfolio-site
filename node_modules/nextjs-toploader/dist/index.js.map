{"version":3,"sources":["../src/index.tsx"],"sourcesContent":["/* eslint-disable max-len */\r\n\r\n/**\r\n *\r\n * NextTopLoader\r\n *\r\n */\r\n\r\n/* eslint-disable prefer-const */\r\n/* eslint-disable quotes */\r\n\r\nimport * as PropTypes from 'prop-types';\r\nimport * as React from 'react';\r\nimport * as NProgress from 'nprogress';\r\nexport type NextTopLoaderProps = {\r\n  /**\r\n   * Color for the TopLoader.\r\n   * @default \"#29d\"\r\n   */\r\n  color?: string;\r\n  /**\r\n   * The initial position for the TopLoader in percentage, 0.08 is 8%.\r\n   * @default 0.08\r\n   */\r\n  initialPosition?: number;\r\n  /**\r\n   * The increament delay speed in milliseconds.\r\n   * @default 200\r\n   */\r\n  crawlSpeed?: number;\r\n  /**\r\n   * The height for the TopLoader in pixels (px).\r\n   * @default 3\r\n   */\r\n  height?: number;\r\n  /**\r\n   * Auto increamenting behaviour for the TopLoader.\r\n   * @default true\r\n   */\r\n  crawl?: boolean;\r\n  /**\r\n   * To show spinner or not.\r\n   * @default true\r\n   */\r\n  showSpinner?: boolean;\r\n  /**\r\n   * Animation settings using easing (a CSS easing string).\r\n   * @default \"ease\"\r\n   */\r\n  easing?: string;\r\n  /**\r\n   * Animation speed in ms for the TopLoader.\r\n   * @default 200\r\n   */\r\n  speed?: number;\r\n  /**\r\n   * Defines a shadow for the TopLoader.\r\n   * @default \"0 0 10px ${color},0 0 5px ${color}\"\r\n   *\r\n   * @ you can disable it by setting it to `false`\r\n   */\r\n  shadow?: string | false;\r\n  /**\r\n   * Defines a template for the TopLoader.\r\n   * @default \"<div class=\"bar\" role=\"bar\"><div class=\"peg\"></div></div>\r\n   * <div class=\"spinner\" role=\"spinner\"><div class=\"spinner-icon\"></div></div>\"\r\n   */\r\n  template?: string;\r\n  /**\r\n   * Defines zIndex for the TopLoader.\r\n   * @default 1600\r\n   *\r\n   */\r\n  zIndex?: number;\r\n  /**\r\n   * To show the TopLoader at bottom.\r\n   * @default false\r\n   *\r\n   */\r\n  showAtBottom?: boolean;\r\n};\r\n\r\nconst NextTopLoader = ({\r\n  color: propColor,\r\n  height: propHeight,\r\n  showSpinner,\r\n  crawl,\r\n  crawlSpeed,\r\n  initialPosition,\r\n  easing,\r\n  speed,\r\n  shadow,\r\n  template,\r\n  zIndex = 1600,\r\n  showAtBottom = false,\r\n}: NextTopLoaderProps) => {\r\n  const defaultColor = '#29d';\r\n  const defaultHeight = 3;\r\n\r\n  const color = propColor ?? defaultColor;\r\n  const height = propHeight ?? defaultHeight;\r\n\r\n  // Any falsy (except undefined) will disable the shadow\r\n  const boxShadow =\r\n    !shadow && shadow !== undefined\r\n      ? ''\r\n      : shadow\r\n      ? `box-shadow:${shadow}`\r\n      : `box-shadow:0 0 10px ${color},0 0 5px ${color}`;\r\n\r\n  // Check if to show at bottom\r\n  const positionStyle = showAtBottom ? 'bottom: 0;' : 'top: 0;';\r\n  const spinnerPositionStyle = showAtBottom ? 'bottom: 15px;' : 'top: 15px;';\r\n  \r\n  const styles = (\r\n    <style>\r\n      {`#nprogress{pointer-events:none}#nprogress .bar{background:${color};position:fixed;z-index:${zIndex};${positionStyle}left:0;width:100%;height:${height}px}#nprogress .peg{display:block;position:absolute;right:0;width:100px;height:100%;${boxShadow};opacity:1;-webkit-transform:rotate(3deg) translate(0px,-4px);-ms-transform:rotate(3deg) translate(0px,-4px);transform:rotate(3deg) translate(0px,-4px)}#nprogress .spinner{display:block;position:fixed;z-index:${zIndex};${spinnerPositionStyle}right:15px}#nprogress .spinner-icon{width:18px;height:18px;box-sizing:border-box;border:2px solid transparent;border-top-color:${color};border-left-color:${color};border-radius:50%;-webkit-animation:nprogress-spinner 400ms linear infinite;animation:nprogress-spinner 400ms linear infinite}.nprogress-custom-parent{overflow:hidden;position:relative}.nprogress-custom-parent #nprogress .bar,.nprogress-custom-parent #nprogress .spinner{position:absolute}@-webkit-keyframes nprogress-spinner{0%{-webkit-transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg)}}@keyframes nprogress-spinner{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}`}\r\n    </style>\r\n  );\r\n\r\n  React.useEffect(() => {\r\n    NProgress.configure({\r\n      showSpinner: showSpinner ?? true,\r\n      trickle: crawl ?? true,\r\n      trickleSpeed: crawlSpeed ?? 200,\r\n      minimum: initialPosition ?? 0.08,\r\n      easing: easing ?? 'ease',\r\n      speed: speed ?? 200,\r\n      template:\r\n        template ??\r\n        '<div class=\"bar\" role=\"bar\"><div class=\"peg\"></div></div><div class=\"spinner\" role=\"spinner\"><div class=\"spinner-icon\"></div></div>',\r\n    });\r\n\r\n    function isAnchorOfCurrentUrl(currentUrl: string, newUrl: string) {\r\n      const currentUrlObj = new URL(currentUrl);\r\n      const newUrlObj = new URL(newUrl);\r\n      // Compare hostname, pathname, and search parameters\r\n      if (\r\n        currentUrlObj.hostname === newUrlObj.hostname &&\r\n        currentUrlObj.pathname === newUrlObj.pathname &&\r\n        currentUrlObj.search === newUrlObj.search\r\n      ) {\r\n        // Check if the new URL is just an anchor of the current URL page\r\n        const currentHash = currentUrlObj.hash;\r\n        const newHash = newUrlObj.hash;\r\n        return (\r\n          currentHash !== newHash && currentUrlObj.href.replace(currentHash, '') === newUrlObj.href.replace(newHash, '')\r\n        );\r\n      }\r\n      return false;\r\n    }\r\n\r\n    // eslint-disable-next-line no-var\r\n    var npgclass = document.querySelectorAll('html');\r\n    function findClosestAnchor(element: HTMLElement | null): HTMLAnchorElement | null {\r\n      while (element && element.tagName.toLowerCase() !== 'a') {\r\n        element = element.parentElement;\r\n      }\r\n      return element as HTMLAnchorElement;\r\n    }\r\n    function handleClick(event: MouseEvent) {\r\n      try {\r\n        const target = event.target as HTMLElement;\r\n        const anchor = findClosestAnchor(target);\r\n        const newUrl = anchor?.href;\r\n        if (newUrl) {\r\n          const currentUrl = window.location.href;\r\n          // const newUrl = (anchor as HTMLAnchorElement).href;\r\n          const isExternalLink = (anchor as HTMLAnchorElement).target === '_blank';\r\n          const isBlob = newUrl.startsWith('blob:');\r\n          const isAnchor = isAnchorOfCurrentUrl(currentUrl, newUrl);\r\n          if (newUrl === currentUrl || isAnchor || isExternalLink || isBlob || event.ctrlKey) {\r\n            NProgress.start();\r\n            NProgress.done();\r\n            [].forEach.call(npgclass, function (el: Element) {\r\n              el.classList.remove('nprogress-busy');\r\n            });\r\n          } else {\r\n            NProgress.start();\r\n            (function (history) {\r\n              const pushState = history.pushState;\r\n              history.pushState = function () {\r\n                NProgress.done();\r\n                [].forEach.call(npgclass, function (el: Element) {\r\n                  el.classList.remove('nprogress-busy');\r\n                });\r\n                // eslint-disable-next-line prefer-rest-params, @typescript-eslint/no-explicit-any\r\n                return pushState.apply(history, arguments as any);\r\n              };\r\n            })(window.history);\r\n          }\r\n        }\r\n      } catch (err) {\r\n        // Log the error in development only!\r\n        // console.log('NextTopLoader error: ', err);\r\n        NProgress.start();\r\n        NProgress.done();\r\n      }\r\n    }\r\n\r\n    // Add the global click event listener\r\n    document.addEventListener('click', handleClick);\r\n\r\n    // Clean up the global click event listener when the component is unmounted\r\n    return () => {\r\n      document.removeEventListener('click', handleClick);\r\n    };\r\n  }, []);\r\n\r\n  return styles;\r\n};\r\nexport default NextTopLoader;\r\n\r\nNextTopLoader.propTypes = {\r\n  color: PropTypes.string,\r\n  height: PropTypes.number,\r\n  showSpinner: PropTypes.bool,\r\n  crawl: PropTypes.bool,\r\n  crawlSpeed: PropTypes.number,\r\n  initialPosition: PropTypes.number,\r\n  easing: PropTypes.string,\r\n  speed: PropTypes.number,\r\n  template: PropTypes.string,\r\n  shadow: PropTypes.oneOfType([PropTypes.string, PropTypes.bool]),\r\n  zIndex: PropTypes.number,\r\n  showAtBottom: PropTypes.bool,\r\n};\r\n"],"mappings":"gmBAAA,IAAAA,EAAA,GAAAC,EAAAD,EAAA,aAAAE,IAAA,eAAAC,EAAAH,GAWA,IAAAI,EAA2B,yBAC3BC,EAAuB,oBACvBC,EAA2B,wBAqE3B,IAAMC,EAAgBC,EAAA,CAAC,CACrB,MAAOC,EACP,OAAQC,EACR,YAAAC,EACA,MAAAC,EACA,WAAAC,EACA,gBAAAC,EACA,OAAAC,EACA,MAAAC,EACA,OAAAC,EACA,SAAAC,EACA,OAAAC,EAAS,KACT,aAAAC,EAAe,EACjB,IAA0B,CACxB,IAAMC,EAAe,OAGfC,EAAQb,GAAA,KAAAA,EAAaY,EACrBE,EAASb,GAAA,KAAAA,EAAc,EAGvBc,EACJ,CAACP,GAAUA,IAAW,OAClB,GACAA,EACA,cAAcA,IACd,uBAAuBK,aAAiBA,IAMxCG,EACJ,gBAAC,aACE,6DAA6DH,4BAAgCH,KAL5EC,EAAe,aAAe,qCAKiGG,uFAA4FC,qNAA6NL,KAJjbC,EAAe,gBAAkB,8IAIgjBE,uBAA2BA,yeACvoB,EAGF,OAAM,YAAU,IAAM,CACV,YAAU,CAClB,YAAaX,GAAA,KAAAA,EAAe,GAC5B,QAASC,GAAA,KAAAA,EAAS,GAClB,aAAcC,GAAA,KAAAA,EAAc,IAC5B,QAASC,GAAA,KAAAA,EAAmB,IAC5B,OAAQC,GAAA,KAAAA,EAAU,OAClB,MAAOC,GAAA,KAAAA,EAAS,IAChB,SACEE,GAAA,KAAAA,EACA,qIACJ,CAAC,EAED,SAASQ,EAAqBC,EAAoBC,EAAgB,CAChE,IAAMC,EAAgB,IAAI,IAAIF,CAAU,EAClCG,EAAY,IAAI,IAAIF,CAAM,EAEhC,GACEC,EAAc,WAAaC,EAAU,UACrCD,EAAc,WAAaC,EAAU,UACrCD,EAAc,SAAWC,EAAU,OACnC,CAEA,IAAMC,EAAcF,EAAc,KAC5BG,EAAUF,EAAU,KAC1B,OACEC,IAAgBC,GAAWH,EAAc,KAAK,QAAQE,EAAa,EAAE,IAAMD,EAAU,KAAK,QAAQE,EAAS,EAAE,EAGjH,MAAO,EACT,CAjBSxB,EAAAkB,EAAA,wBAoBT,IAAIO,EAAW,SAAS,iBAAiB,MAAM,EAC/C,SAASC,EAAkBC,EAAuD,CAChF,KAAOA,GAAWA,EAAQ,QAAQ,YAAY,IAAM,KAClDA,EAAUA,EAAQ,cAEpB,OAAOA,CACT,CALS3B,EAAA0B,EAAA,qBAMT,SAASE,EAAYC,EAAmB,CACtC,GAAI,CACF,IAAMC,EAASD,EAAM,OACfE,EAASL,EAAkBI,CAAM,EACjCV,EAASW,GAAA,YAAAA,EAAQ,KACvB,GAAIX,EAAQ,CACV,IAAMD,EAAa,OAAO,SAAS,KAE7Ba,EAAkBD,EAA6B,SAAW,SAC1DE,EAASb,EAAO,WAAW,OAAO,EAClCc,EAAWhB,EAAqBC,EAAYC,CAAM,EACpDA,IAAWD,GAAce,GAAYF,GAAkBC,GAAUJ,EAAM,SAC/D,QAAM,EACN,OAAK,EACf,CAAC,EAAE,QAAQ,KAAKJ,EAAU,SAAUU,EAAa,CAC/CA,EAAG,UAAU,OAAO,gBAAgB,CACtC,CAAC,IAES,QAAM,EACf,SAAUC,EAAS,CAClB,IAAMC,EAAYD,EAAQ,UAC1BA,EAAQ,UAAY,UAAY,CAC9B,OAAU,OAAK,EACf,CAAC,EAAE,QAAQ,KAAKX,EAAU,SAAUU,EAAa,CAC/CA,EAAG,UAAU,OAAO,gBAAgB,CACtC,CAAC,EAEME,EAAU,MAAMD,EAAS,SAAgB,CAClD,CACF,EAAG,OAAO,OAAO,GAGvB,OAASE,EAAP,CAGU,QAAM,EACN,OAAK,CACjB,CACF,CAtCS,OAAAtC,EAAA4B,EAAA,eAyCT,SAAS,iBAAiB,QAASA,CAAW,EAGvC,IAAM,CACX,SAAS,oBAAoB,QAASA,CAAW,CACnD,CACF,EAAG,CAAC,CAAC,EAEEX,CACT,EAhIsB,iBAiIfsB,EAAQxC,EAEfA,EAAc,UAAY,CACxB,MAAiB,SACjB,OAAkB,SAClB,YAAuB,OACvB,MAAiB,OACjB,WAAsB,SACtB,gBAA2B,SAC3B,OAAkB,SAClB,MAAiB,SACjB,SAAoB,SACpB,OAAkB,YAAU,CAAW,SAAkB,MAAI,CAAC,EAC9D,OAAkB,SAClB,aAAwB,MAC1B","names":["src_exports","__export","src_default","__toCommonJS","PropTypes","React","NProgress","NextTopLoader","__name","propColor","propHeight","showSpinner","crawl","crawlSpeed","initialPosition","easing","speed","shadow","template","zIndex","showAtBottom","defaultColor","color","height","boxShadow","styles","isAnchorOfCurrentUrl","currentUrl","newUrl","currentUrlObj","newUrlObj","currentHash","newHash","npgclass","findClosestAnchor","element","handleClick","event","target","anchor","isExternalLink","isBlob","isAnchor","el","history","pushState","err","src_default"]}